{% extends 'base.html' %}

{% block title %}
Search with The Tribune
{% endblock %}

{% block style %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/search_view.css' %}">
{% endblock %}



{% block content %}


<header id="header">
    <div id="date-container">
        <button>
            <div></div>
            <div></div>
            <div></div>
        </button>
        <p>{{current_date}}</p>
    </div>
    
    <div id="header-logo"><img src="{% static '\icons\full-logo.svg' %}" alt="">
    </div>
</header>


<form method="GET" action="{% url 'search' %}">
    {% csrf_token %}
    <h2>Search</h2>
    <div id="input-container">
        <img src="{% static '\icons\search.svg' %}" alt="">
        <input type="text" name="query" placeholder="Search headlines" value="{{query}}"
        >
    </div>
    
    <div id="filters-results-container">
        <div id="filters">
            <h2>Filters</h2>
            <div id="filters-container">
                <div id="start-year" class="filter-group">
                    <label for="start_year">From Year:</label>
                    <!-- <input type="text"> -->
                    <select id="start_year" name="start_year"
                        onchange="updateToYearOptions()">
                        <option value="">Select Year</option>
                        {% for year in years %}
                        <option value="{{ year }}" 
                        {% if year == start_year|add:"0" %}
                            selected
                        {% endif %}
                        >{{ year }}
                        </option>
                        
                        {% endfor %}
                    </select>
            
                
                    <!-- <p>{% if start_yr == '2000' %}{{start_yr}}{% endif %}</p> -->
                    
        
                </div>
    
                <div id="end-year" class="filter-group">
                    <label for="end_year">To Year:</label>
                    <select id="end_year" name="end_year"
                        onchange="updateFromYearOptions()">
                        <option value="">Select Year</option>
                        {% for year in years %}
                        <option value="{{ year }}"
                        {% if year == end_year|add:"0" %}
                            selected
                        {% endif %}
                        >{{ year }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
    
                <div id="fromMonth" class="{% if start_year and end_year %}filter-group{% else %}hidden{% endif %}">
                    <label for="start_month">From Month:</label>
                    <select name="start_month" id="start_month"
                        onchange="updateToMonthOptions()">
                        <option value="">Any Month</option>
                        
                        {% for month in months %}
                        <option value="{{ month }}"
                        {% if month == start_month %}
                            selected
                        {% endif %}
                        >{{ month }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
    
                <div id="toMonth" class=" {% if start_year and end_year %}filter-group{% else %}hidden{% endif %}">
                    <label for="end_month">To Month:</label>
                    <select name="end_month" id="end_month"
                        onchange="updateFromMonthOptions()">
                        <option value="">Any Month</option>
                        {% for month in months %}
                        <option value="{{ month }}" 
                        {% if month == end_month %}
                            selected
                        {% endif %}
                        >{{ month }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
        
                <div class="filter-group">
                    <label for="has_tag">Has Tag:</label>
                    <input type="checkbox" name="has_tag" value="1" class="ml-2" {% if has_tag %}checked{% endif %}>
                </div>
    
                <div class="filter-group">
                    <label for="category">Category:</label>
                    <select name="category">
                        <option value="">All Categories</option>
                        {% for category in categories %}
                        <option value="{{ category.id }}" {% if category.id == category_id|add:"0" %}selected{% endif %}>
                            {{ category.category_name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            
        </div>
    
        <div id="search_results">
            {% if articles %}
            <div>
                {% for article in articles %}
                <div class="article-group">
                    <div class="article-photo-container">
                        {% if article.photo %}
                        <img src="{{ MEDIA_URL }}{{ article.photo.photo.url }}" alt="Photo for {{ article.headline }}">
                        {% endif %}
                    </div>

                    <div class="headline-container">
                        <p>{{ article.tag.tag_name }}</p>
                        
                         <a href="{% url 'full_article_view' article.id %}" class="hover:underline">
                            <h2>{{ article.headline }}</h2>
                        </a>
                        
                        <p class="date-published">{{ article.date_published }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
    
            {% else %}
            <p>No articles found.</p>
            {% endif %}
        </div>
    </div>





</form>


{%load static%}

<script src="{%static 'js/search_results.js'%}"></script>
{% endblock %}