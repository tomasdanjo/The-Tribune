{% extends 'base.html' %}
{% load static %}

{% block title %}
    {{ user.userprofile.first_name}} {{ user.userprofile.last_name }}
{% endblock %}

{% block style %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/writer-editor.css' %}"> 
{% endblock %}

{% block content %}

{% include 'header.html' %}

<div id="main">

    <nav>
        <button onclick="showSection('published-section')">
        <img src="{% static 'icons/published.svg' %}" alt="">
            <p>Published</p></button>
        <button onclick="showSection('draft-section')" >
           <img src="{% static 'icons/draft.svg' %}" alt=""> <p>Draft</p></button>
        <button onclick="showSection('archived-section')" ><img src="{% static 'icons/archive.svg' %}" alt=""><p>Archived</p></button>
        <button onclick="showSection('review-section')" ><img src="{% static 'icons/review.svg' %}" alt=""><p>Review</p></button>
        <button onclick="showSection('notification-section')" ><img src="{% static 'icons/notif.svg' %}" alt=""><p>Notification</p></button>
        <a id="write-article-btn" href="{% url 'create_article' %}"><img src="{% static 'icons/write.svg' %}" alt=""><p>Write Article</p></a>  
    </nav>
        

    <div id="content">
        <div id="published-section" class="article-section">
            <h2>Published Articles</h2>
            <div class="article-card-container">
                <div class="article-card-grid">
                    {{ published }}
                </div>
            </div>
        </div>
        
        <div id="draft-section" class="article-section">
            <h2>Drafted Articles</h2>
            <div class="article-card-container">
                <div class="article-card-grid">
                    {{ drafts }}
                </div>
            </div>
        </div>

        <div id="archived-section" class="article-section">
            <h2>Archived Articles</h2>
            <div class="article-card-container">
                <div class="article-card-grid">
                    {{ archived }}
                </div>
            </div>
        </div>

        <div id="review-section" class="article-section">
            <h2>Articles Under Revision</h2>
            <div class="article-card-container">
                <div class="article-card-grid">
                    {{ review }}
                </div>
            </div>
        </div>
    

        <div id="notification-section">

        </div>
    </div>



    
</div>

<script>
    function toggleDropdown() {
        var dropdown = document.getElementById("profile-dropdown");
        dropdown.classList.toggle("hidden");
    }
</script>

<script>
    function logoutUser() {
        const csrfToken = '{{ csrf_token }}';  // Get the CSRF token from the template context
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = "{% url 'logout' %}";  // The logout URL
    
        // Create a hidden CSRF token field
        const csrfField = document.createElement('input');
        csrfField.type = 'hidden';
        csrfField.name = 'csrfmiddlewaretoken';
        csrfField.value = csrfToken;
    
        // Append the CSRF token field to the form
        form.appendChild(csrfField);
    
        // Append the form to the body (it won't be visible to the user)
        document.body.appendChild(form);
    
        // Submit the form
        form.submit();
    }
</script>

<script>
    // Function to show the selected section and hide the others
    function showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.article-section').forEach(section => {
            section.classList.add('hidden');
        });

        // Show the selected section
        document.getElementById(sectionId).classList.remove('hidden');
        
        // Remove 'selected' class from all buttons
    document.querySelectorAll('nav button').forEach(button => {
        button.classList.remove('selected');
    });

    // Add 'selected' class to the clicked button
    const clickedButton = [...document.querySelectorAll('nav button')].find(button => 
        button.onclick.toString().includes(sectionId)
    );
    if (clickedButton) clickedButton.classList.add('selected');


    }

    // Initially, show the 'published' section
    document.addEventListener('DOMContentLoaded', function() {
        showSection('published-section');
    });
</script>

<style>
    .hidden {
        display: none;
    }
</style>
{% endblock %}
